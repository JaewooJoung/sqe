---
layout: default
title: Severity Check for Code Testing
---

<div class="container">
  <div class="controls">
    <select id="severity">
      {% for level in site.data.severity_matrix.asil_levels.severity %}
        <option value="{{ level.id }}">{{ level.id }} - {{ level.name }}</option>
      {% endfor %}
    </select>
    
    <select id="exposure">
      {% for level in site.data.severity_matrix.asil_levels.exposure %}
        <option value="{{ level.id }}">{{ level.id }} - {{ level.name }}</option>
      {% endfor %}
    </select>
    
    <select id="controllability">
      {% for level in site.data.severity_matrix.asil_levels.controllability %}
        <option value="{{ level.id }}">{{ level.id }} - {{ level.name }}</option>
      {% endfor %}
    </select>
  </div>

  <table id="riskMatrix">
    <tr>
      <th>Controllability</th>
      <th>Exposure</th>
      <th colspan="4" class="severity-header">Severity</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      {% for level in site.data.severity_matrix.asil_levels.severity %}
        <th>{{ level.id }}</th>
      {% endfor %}
    </tr>
    
    {% for c_entry in site.data.severity_matrix.risk_matrix %}
      {% assign c_id = c_entry[0] %}
      {% assign e_data = c_entry[1] %}
      
      {% for e_entry in e_data %}
        {% assign e_id = e_entry[0] %}
        {% assign s_data = e_entry[1] %}
        
        <tr>
          <td>{% if forloop.first %}{{ c_id }}{% endif %}</td>
          <td>{{ e_id }}</td>
          
          {% for s_level in site.data.severity_matrix.asil_levels.severity %}
            {% assign value = s_data[s_level.id] %}
            <td class="{{ value | downcase }}" 
                data-c="{{ c_id }}"
                data-e="{{ e_id }}"
                data-s="{{ s_level.id }}">
              {{ value }}
            </td>
          {% endfor %}
        </tr>
      {% endfor %}
    {% endfor %}
  </table>
</div>

<style>
  .container {
    max-width: 1000px;
    margin: 20px auto;
    font-family: Arial, sans-serif;
  }
  .controls {
    margin-bottom: 20px;
  }
  select {
    padding: 8px;
    margin-right: 15px;
    min-width: 200px;
  }
  table {
    border-collapse: collapse;
    width: 100%;
  }
  th, td {
    border: 1px solid #000;
    padding: 12px;
    text-align: center;
  }
  th {
    background-color: white;
    font-weight: bold;
  }
  .highlighted {
    border: 2px solid red !important;
  }
  .qm { background-color: #e8f5e9; }
  .a { background-color: #fff9c4; }
  .b { background-color: #ffe0b2; }
  .c { background-color: #ffcdd2; }
  .d { background-color: #ff8a80; }
  .severity-header {
    font-size: 1.2em;
    font-weight: bold;
  }
</style>

<script>
  function highlightCell() {
    const severity = document.getElementById('severity').value;
    const exposure = document.getElementById('exposure').value;
    const controllability = document.getElementById('controllability').value;
    
    document.querySelectorAll('.highlighted').forEach(el => 
      el.classList.remove('highlighted')
    );
    
    const cell = document.querySelector(
      `[data-c="${controllability}"][data-e="${exposure}"][data-s="${severity}"]`
    );
    if (cell) cell.classList.add('highlighted');
  }

  ['severity', 'exposure', 'controllability'].forEach(id => {
    document.getElementById(id).addEventListener('change', highlightCell);
  });

  highlightCell();
</script>
